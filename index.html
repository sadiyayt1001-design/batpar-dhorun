<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Batpar Dharun</title>

<style>
body{
    margin:0;
    font-family:Arial;
    background:#f4f4f4;
}
header{
    background:#111;
    color:white;
    padding:15px;
    text-align:center;
}
.container{
    width:95%;
    max-width:500px;
    margin:auto;
    margin-top:20px;
}
.card{
    background:white;
    padding:15px;
    margin-bottom:15px;
    border-radius:8px;
    box-shadow:0 2px 5px rgba(0,0,0,0.2);
}
input,button,textarea{
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:5px;
    border:1px solid #ccc;
}
button{
    background:#007bff;
    color:white;
    border:none;
}
button:hover{
    background:#0056b3;
}
.hidden{
    display:none;
}
.post{
    border-bottom:1px solid #ddd;
    padding:8px 0;
}
.admin{
    background:#ffeeba;
}
</style>
</head>

<body>

<header>
<h2>Batpar Dharun System</h2>
</header>

<div class="container">

<div class="card" id="registerBox">
<h3>Register</h3>
<input type="text" id="regUser" placeholder="Username">
<input type="password" id="regPass" placeholder="Password">
<button onclick="register()">Register</button>
</div>

<div class="card">
<h3>Login</h3>
<input type="text" id="loginUser" placeholder="Username">
<input type="password" id="loginPass" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<div class="card hidden" id="adminPanel">
<h3>Admin Upload</h3>
<textarea id="postContent" placeholder="Write Post"></textarea>
<button onclick="uploadPost()">Upload Post</button>
</div>

<div class="card hidden" id="moderatorPanel">
<h3>Moderator Approval</h3>
<div id="pendingPosts"></div>
</div>

<div class="card">
<h3>Approved Posts</h3>
<div id="posts"></div>
</div>

</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || [];
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let currentUser = null;

function saveData(){
    localStorage.setItem("users", JSON.stringify(users));
    localStorage.setItem("posts", JSON.stringify(posts));
}

function register(){
    let u = regUser.value;
    let p = regPass.value;
    if(u && p){
        users.push({username:u, password:p, role:"user"});
        saveData();
        alert("Registered Successfully");
    }
}

function login(){
    let u = loginUser.value;
    let p = loginPass.value;

    let user = users.find(x=>x.username==u && x.password==p);

    if(u=="admin" && p=="1234"){
        currentUser = {role:"admin"};
        adminPanel.classList.remove("hidden");
        moderatorPanel.classList.remove("hidden");
        alert("Admin Login");
    }
    else if(user){
        currentUser = user;
        if(user.role=="moderator"){
            moderatorPanel.classList.remove("hidden");
        }
        alert("User Login");
    }
    else{
        alert("Wrong Login");
    }
}

function uploadPost(){
    let content = postContent.value;
    if(content){
        posts.push({text:content, approved:false});
        saveData();
        showPending();
        postContent.value="";
    }
}

function showPending(){
    pendingPosts.innerHTML="";
    posts.filter(p=>!p.approved).forEach((p,i)=>{
        pendingPosts.innerHTML += `
        <div class="post">
            ${p.text}
            <button onclick="approve(${i})">Approve</button>
        </div>
        `;
    });
}

function approve(i){
    posts[i].approved=true;
    saveData();
    showPending();
    showPosts();
}

function showPosts(){
    postsDiv = document.getElementById("posts");
    postsDiv.innerHTML="";
    posts.filter(p=>p.approved).forEach(p=>{
        postsDiv.innerHTML+=`
        <div class="post">${p.text}</div>
        `;
    });
}

showPosts();
showPending();
</script>

</body>
</html>
